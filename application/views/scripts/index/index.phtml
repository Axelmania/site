<?php
// some variable initiation
$url_tag_cloud = $this->url(array('controller' => 'tag',
                                  'action' => 'index',
                                  'language' => $this->language), 
                            'lang_default', true);
    
$url_sign_up = $this->url(array('controller' => 'account',
                                'action' => 'register',
                                'language' => $this->language), 
                          'lang_default', true);
    
$url_more = $this->url(array('controller' => 'search',
                              'action' => 'result',
                              'page' => '2',
                              'language' => $this->language), 
                        'lang_default', true);
?>

<h3 class="recent_posts"><?php echo $this->translate('index-recent-posts'); ?></h3>
			
<!-- Small hack to force a small space between the h2 and content... might help the Symbian -browsers a bit -->
<div style="height: 2px;"></div>

<div class="user_content_list" style="padding: 0px; margin: 0px; overflow:hidden;">

<?php 
    if (isset($this->recentposts) && $this->recentposts != null && $this->recentposts != '') {
        echo $this->partialLoop('partials/content_row.phtml', $this->recentposts);
    }
?>
    <div class="user_content_spacer">
        <img src="<?php echo $this->baseUrl('/images/gray_dot_line_500.png'); ?>" alt="Massidea.org" />
    </div>
    
    <div style="margin-top: 10px; margin-left: 220px;">
        <h3>
            <a href="<?php echo $url_more; ?>">
                <?php echo $this->translate('index-view-more'); ?>
            </a>
        </h3>
    </div>
</div>

<?php 
/*
Assign the partial view to the layout :) 
If there is nothing, the layout just prints nothing. 
However, if you assign a file that does not exist, the site will 
throw an application error instantly, so be careful!

Commented to fix temporary problem, will be researched further later
*/
//$this->layout()->right_side = $this->partial('partials/index.phtml'); 
?>
<div class="right_side" style="padding: 0px; margin: 0px; margin-top: -52px;">
    <!-- For some mystical reason, paragraphs seem to need an empty style-attribute in order to extend a CSS -class -->
    <h4 style="margin-top: 8px; margin-bottom: 6px;">
        <?php echo $this->translate('index-what-is'); ?>
    </h4>
        <div class="top_right_box">
            <?php echo $this->translate('index-what-is-long'); ?>
            <?php // <span class="top_right_box_links"><a href="#"> echo $this->translate('index-learn-more'); </a></span> ?>
        </div>
        
    <?php if(!$this->isLoggedIn): ?>
    <p id="sign_up_now" style="padding-bottom: 10px;" class="top_right_box_links">
        <b>
            <a href="<?php echo $url_sign_up; ?>">
                <?php echo $this->translate('index-sigup')?>
            </a>
        </b>
    </p>
    <?php endif; ?>
    
    <h3 style="margin-top: 5px; margin-bottom: 0; padding: 0;">
        <?php echo $this->translate('index-most-popular')?>
        <a href="<?php echo $url_tag_cloud; ?>">
            <?php echo $this->translate('index-tags')?>
        </a>
    </h3>
    
    <img src="<?php echo $this->baseUrl('/images/gray_dot_line_200.png'); ?>" alt="Massidea.org" />
    
    <div class="tag_cloud">
       
        <?php echo $this->partialLoop('partials/tag.phtml', $this->poptags); ?>
        
        <p id="show_all_tags" style="padding: 0px; margin-top: 10px;" class="top_right_box_links">
            <a href="<?php echo $url_tag_cloud; ?>">
                <?php echo $this->translate('index-show-all')?>
            </a>
        </p>
    </div>
    
    <img src="<?php echo $this->baseUrl('/images/gray_dot_line_200.png'); ?>" alt="Massidea.org" />
    
    <p id="most_active_users" style="padding: 0px;" class="top_right_box_links">
        <?php echo $this->translate('index-most-active')?>
        <a href="#">
            <?php echo $this->translate('index-users')?>
        </a>
    </p>
    
    <img src="<?php echo $this->baseUrl('/images/gray_dot_line_200.png'); ?>" alt="Massidea.org" />
    
    <div class="top_right_box_links_users">
        <?php echo $this->partialLoop('partials/user_row.phtml', $this->activeusers); ?>
    </div>
    
    <div class="top_right_box_links_show_all_users">
        <a href="#">
            <?php echo $this->translate('index-show-all')?>
            <?php echo $this->translate('index-users')?>
        </a>
    </div>
    
    <img src="<?php echo $this->baseUrl('/images/gray_dot_line_200.png'); ?>" alt="Massidea.org" />
    
    <div class="massidea_dev_info">
        <?php echo $this->translate('index-opensource')?>
    </div>
</div>